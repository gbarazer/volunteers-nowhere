<template name="metaleadDepartmentView">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-2">
        <h3>{{ name }}</h3>
        <h5 class="mb-2 text-muted">{{_ "leads"}}</h5>
        <ul>
          {{#each lead in leadsDept}}
            <li>{{getUserName lead.userId}}</li>
          {{/each}}
        </ul>
        <h5 class="mb-2 text-muted">{{_ "information"}}</h5>
        <ul>
          <li>{{_ "teams"}}: {{ teamsNumber }}</li>
          <li>{{_ "leads"}}: {{allLeads.wanted}}/{{allLeads.covered}}</li>
          <li>{{_ "shifts"}}: {{shiftsDept.wanted}}/{{shiftsDept.covered}}</li>
          <li>{{_ "volunteer"}}: xxx</li>
        </ul>
        <button type="button" class="btn btn-default btn-sm" data-action="add_team">
          {{fa "wrench"}} {{_ "add_team" }}
        </button>
      </div>
      <div class="col-md-5">
        <h3>{{_ "all_teams"}}</h3>
        <table class="table">
          <thead>
            <th>{{_ "name"}}</th>
            <th>{{_ "leads"}}</th>
            <th>{{_ "wanted/covered"}}</th>
            <th></th>
          </thead>
          {{#each team in allTeams}}
            <tr>
              <td><a href="{{pathFor "leadTeamView" _id=team._id}}"> {{team.name}}</a></td>
              <td>{{#each lead in (leadsTeam team)}}{{getUserName lead.userId}}{{/each}}</td>
              <td><span class="badge badge-pill badge-primary">
                {{#let s = (shiftsTeam team._id)}}
                  {{s.wanted}}/{{s.covered}}
                {{/let}}
                </span></td>
              <td>
                <div class="btn-group pull-right">
                  <button type="button" class="btn btn-default dropdown-toggle"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <span class="caret"></span>
                  </button>
                  <ul class="dropdown-menu">
                    <li class="dropdown-item"><a href="#" data-action="edit_team" data-id="{{team._id}}">
                      {{fa "pencil-square-o"}} {{_ "edit"}}</a></li>
                    <li class="dropdown-item"><a href="#" data-action="delete_team" data-id="{{team._id}}">
                      {{fa "trash-o"}} {{_ "remove"}}</a></li>
                    <li class="dropdown-item"><a href="#" data-action="enroll_lead" data-id="{{team._id}}">
                      {{fa "user"}} {{_ "enroll_lead"}}</a></li>
                  </ul>
                </div>
              </td>
            </tr>
          {{/each}}
        </table>
        <!-- {{#markdown}}
        Collect and show all aggregated data regarding this department, including:

        - highlight teams that do not have a lead
        - highlight teams with a low completition rate
        - highlight teams with pending requests
        - show leads activity
        - nice graph showing the rate of signup over time
        - completition rate for the whole dept
        {{/markdown}} -->
      </div>
      <div class="col-md-5">
        <h3>{{_ "pending_requests"}}</h3>
        {{> departmentSignupsList }}
      </div>
    </div>
  </div>
</template>
